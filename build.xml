<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." default="all" name="i2p">
    <target name="all" >
        <echo message="Useful targets: " />
        <echo message="  build:     build existing code into ./build/, but dont clean" />
        <echo message="  javadoc:   generate javadoc for the entire project into ./build/javadoc" />
        <echo message="  clean:     clean up the ./build/ dir" />
        <echo message="  distclean: clean up all derived files" />
        <echo message="  dist:      distclean, then build and javadoc" />
    </target>
    <target name="dist" depends="distclean, build, javadoc" />
    <target name="build" depends="builddep, jar" />
    <target name="builddep">
	<!-- build *everything* here, but only once -->
        <ant dir="core/java/" target="jar" />
        <ant dir="router/java/" target="jar" />
        <ant dir="apps/ministreaming/java/" target="jar" />
        <ant dir="apps/i2ptunnel/java/" target="jar" />
        <ant dir="apps/httptunnel/java/" target="jar" />
        <ant dir="apps/phttprelay/java/" target="jar" />
        <ant dir="apps/sam/java/" target="jar" />
        <ant dir="apps/heartbeat/java/" target="jar" />
        <ant dir="installer/java/" target="jar" />
    </target>
    <target name="compile" />
    <target name="jar" depends="compile" >
        <copy file="core/java/build/i2p.jar" todir="build/" />
        <copy file="router/java/build/router.jar" todir="build/" />
        <copy file="apps/ministreaming/java/build/mstreaming.jar" todir="build/" />
        <copy file="apps/i2ptunnel/java/build/i2ptunnel.jar" todir="build/" />
        <copy file="apps/httptunnel/java/build/httptunnel.jar" todir="build/" />
        <copy file="apps/phttprelay/java/build/phttprelay.war" todir="build/" />
        <copy file="apps/sam/java/build/sam.jar" todir="build/" />
        <copy file="apps/heartbeat/java/build/heartbeat.jar" todir="build/" />
        <copy file="installer/java/build/install.jar" todir="build/" />
        <copy file="installer/java/build/guiinstall.jar" todir="build/" />
        <copy file="installer/java/build/fetchseeds.jar" todir="build/" />
    </target>
    <target name="javadoc">
        <mkdir dir="./build" />
        <mkdir dir="./build/javadoc" />
        <javadoc 
            sourcepath="core/java/src:core/java/test:router/java/src:router/java/test:apps/ministreaming/java/src:apps/i2ptunnel/java/src:apps/httptunnel/java/src" 
            destdir="./build/javadoc" 
            packagenames="*" 
            use="true" 
            splitindex="true" 
            windowtitle="I2P" />
    </target>
    <target name="clean">
        <delete dir="./build" />
    </target>
    <target name="distclean" depends="clean">
        <ant dir="core/java/" target="distclean" />
        <ant dir="router/java/" target="distclean" />
        <ant dir="apps/ministreaming/java/" target="distclean" />
        <ant dir="apps/i2ptunnel/java/" target="distclean" />
        <ant dir="apps/httptunnel/java/" target="distclean" />
        <ant dir="apps/phttprelay/java/" target="distclean" />
        <ant dir="apps/sam/java/" target="distclean" />
        <ant dir="apps/heartbeat/java/" target="distclean" />
        <ant dir="installer/java/" target="distclean" />
    </target>
</project>
